'use strict';var _extends=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a};Object.defineProperty(exports,'__esModule',{value:!0});exports.default=storageify;var _xstream=require('xstream'),_xstream2=_interopRequireDefault(_xstream);function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function _serialize(a){return JSON.stringify(a)}function _deserialize(a){try{return JSON.parse(a)}catch(a){}}var _key='appState';function storageify(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return _storageify(a,b)}function _storageify(a,b){var c=b.key,d=c===void 0?_key:c,e=b.serialize,f=e===void 0?_serialize:e,g=b.deserialize,h=g===void 0?_deserialize:g;if('function'!=typeof a)throw new Error('storageify\'s first argument must be of type \'function\'.');if('string'!=typeof d)throw new Error('key option must be of type \'string\'.');if('function'!=typeof h)throw new Error('deserialize option must be of type \'function\'.');if('function'!=typeof f)throw new Error('serialize option must be of type \'function\'.');return function(b){var c=a(b),e=c.onion,g=b.storage.local.getItem(d).take(1).map(h).map(function(a){return e.startWith(function(b){return a||b})}).flatten(),i=b.onion.state$.map(f).map(function(a){return{key:d,value:a}}),j=c.storage?_xstream2.default.merge(i,c.storage):i,k=_extends({},c,{onion:g,storage:j});return k}}
//# sourceMappingURL=storageify.js.map